---
title: Getting Started with Teleport Application Access
description: Getting started with Teleport application access.
videoBanner: 5Uwhp3IQMHY
version: '13.x'
---

Let's connect to Grafana using Teleport in three steps:

- Launch Grafana in a Docker container or Kubernetes cluster.
- Install the Teleport Application Service and configure it to proxy Grafana.
- Access Grafana through Teleport.

![Teleport Application Access Grafana Self-Hosted](../../../../../assets/grafana_selfhosted-c95f05a96d.png)

![Teleport Application Access Grafana Cloud](../../../../../assets/grafana_cloud-375fd02fa8.png)

## Prerequisites

<Tabs>
  <Tab title="Open Source">
    - A running Teleport cluster. For details on how to set this up, see our
      [Getting Started](/docs/ver/13.x/index) guide.

    - The `tctl` admin tool and `tsh` client tool version >= 13.2.0.

      ```code
      $ tctl version
      # Teleport v13.2.0 go1.20

      $ tsh version
      # Teleport v13.2.0 go1.20
      ```

      See [Installation](/docs/ver/13.x/installation) for details.
  </Tab>

  <Tab title="Enterprise">
    - A running Teleport Enterprise cluster. For details on how to set this up, see our Enterprise
      [Getting Started](/docs/ver/13.x/choose-an-edition/teleport-enterprise/introduction) guide.

    - The Enterprise `tctl` admin tool and `tsh` client tool version >= 13.2.0,
      which you can download by visiting your [Teleport account](https://teleport.sh).

      ```code
      $ tctl version
      # Teleport Enterprise v13.2.0 go1.20

      $ tsh version
      # Teleport v13.2.0 go1.20
      ```
  </Tab>

  <Tab title="Teleport Cloud">
    - A Teleport Enterprise Cloud account. If you do not have one, visit the [signup
      page](https://goteleport.com/signup/) to begin a free trial of Teleport Team
      and upgrade to Teleport Enterprise Cloud.

    - The Enterprise `tctl` admin tool and `tsh` client tool version >= 13.2.0.
      To download these tools, visit the [Downloads](/docs/ver/13.x/choose-an-edition/teleport-cloud/downloads) page.

      ```code
      $ tctl version
      # Teleport Enterprise v13.2.0 go1.20

      $ tsh version
      # Teleport v13.2.0 go1.20
      ```
  </Tab>
</Tabs>

- Make sure you can connect to Teleport. Log in to your cluster using `tsh`, then use `tctl`
  remotely:
  ```code
  $ tsh login --proxy=teleport.example.com --user=email@example.com
  $ tctl status
  # Cluster  teleport.example.com
  # Version  13.2.0
  # CA pin   sha256:abdc1245efgh5678abdc1245efgh5678abdc1245efgh5678abdc1245efgh5678
  ```
  You can run subsequent `tctl` commands in this guide on your local machine.

  For full privileges, you can also run `tctl` commands on your Auth Service host.
  ```code
  $ tsh login --proxy=myinstance.teleport.sh --user=email@example.com
  $ tctl status
  # Cluster  myinstance.teleport.sh
  # Version  13.2.0
  # CA pin   sha256:sha-hash-here
  ```
  You must run subsequent `tctl` commands in this guide on your local machine.
- A host where you will run the Teleport Application Service.

<Tabs>
  <Tab title="Docker">
    - A Docker installation, which we will use to launch Grafana in a container.
      Alternatively, if you have another web application you'd like to protect with
      Teleport, you can use that instead.
  </Tab>

  <Tab title="Kubernetes Cluster">
    - [Kubernetes](https://kubernetes.io) >= v1.17.0
    - [Helm](https://helm.sh) >= 3.4.2

      Verify that Helm and Kubernetes are installed and up to date.

      ```code
      $ helm version
      # version.BuildInfo{Version:"v3.4.2"}

      $ kubectl version
      # Client Version: version.Info{Major:"1", Minor:"17+"}
      # Server Version: version.Info{Major:"1", Minor:"17+"}
      ```

    - Administrative rights to deploy within a cluster.
  </Tab>
</Tabs>

<Tip>
  {/*lint ignore messaging*/}

  If you have not yet deployed the Auth Service and Proxy Service, you should
  follow one of our [getting started guides](/docs/ver/13.x/index) or try our
  Teleport Application Access [interactive learning track](https://play.instruqt.com/teleport/invite/rgvuva4gzkon).
</Tip>

<Note>
  Teleport assigns a subdomain to each application you have configured for Application
  Access (e.g., `grafana.teleport.example.com`), so you will need to ensure that a
  DNS A (or CNAME for services that only provide a hostname) record exists for each
  application-specific subdomain so clients can access your applications via Teleport.

  You should create either a separate DNS record for each subdomain, or a single
  record with a wildcard subdomain such as `*.teleport.example.com`. This way, your
  certificate authority (e.g., Let's Encrypt) can issue a certificate for each
  subdomain, enabling clients to verify your Teleport hosts regardless of the
  application they are accessing.

  Teleport Cloud will automatically provide a subdomain and signed TLS certificate
  for your application under your tenant address.
</Note>

## Step 1/4. Generate a token

A join token is required to authorize a Teleport Application Service instance to
join the cluster. Generate a short-lived join token and save it, for example,
in `/tmp/token`:

```code
$ tctl tokens add \
    --type=app \
    --app-name=grafana \
    --app-uri=http://localhost:3000
```

<Tabs>
  <Tab title="Docker">
    ## Step 2/4. Start Grafana

    We've picked Grafana for this tutorial since it's very easy to run with zero
    configuration required. If you have another web application you'd like to
    expose, skip over to **Step 3**.

    Grafana can be launched in a Docker container with a single command:

    ```code
    $ docker run -d --name grafana -p 3000:3000 grafana/grafana
    ```

    Next, we need to edit `/etc/grafana/grafana.ini` in the container. Under
    `[server]`, uncomment the `domain` key and set the value to your Teleport
    cluster domain, (e.g., `teleport.example.com`). Since there is no text editor
    installed in the container, we can do this with `sed`:

    ```code
    $ docker exec -u 0 grafana sed -i 's/;domain = localhost/domain = teleport.example.com/g' /etc/grafana/grafana.ini
    ```

    Replace `teleport.example.com` with your Teleport cluster domain.

    ## Step 3/4. Install and configure Teleport

    <Accordion title="Before you begin: read security tips">
      When running Teleport in production, we recommend that you follow the
      practices below to avoid security incidents. These practices may differ from
      the examples used in this guide, which are intended for demo environments:

      - Avoid using `sudo` in production environments unless it's necessary.
      - Create new, non-root, users and use test instances for experimenting with Teleport.
      - Run Teleport's services as a non-root user unless required. Only the SSH
        Service requires root access. Note that you will need root permissions (or
        the `CAP_NET_BIND_SERVICE` capability) to make Teleport listen on a port
        numbered \< `1024` (e.g. `443`).
      - Follow the "Principle of Least Privilege" (PoLP). Don't give users
        permissive roles when giving them more restrictive roles will do instead.
        For example, don't assign users the built-in `access,editor` roles, which give
        them permissions to access and edit all cluster resources. Instead, define
        RBAC roles with the minimum required permissions for each user and configure
        Access Requests for elevated permissions.
      - When joining a Teleport resource service (e.g., the Database Service or
        Application Service) to a cluster, save the invitation token to a file.
        Otherwise, the token will be visible when examining the `teleport` command
        that started the agent, e.g., via the `history` command on a compromised
        system.
    </Accordion>

    ### Configure and Start Teleport

    Install Teleport on the host where you will run the Teleport Application Service. See our [Installation](/docs/ver/13.x/installation) page for options besides Linux servers.

    Use the appropriate commands for your environment to install your package:

    <Tabs dropdownView dropdownCaption="Teleport Edition">
      <Tab title="Open Source">
        ```code
        $ curl https://goteleport.com/static/install.sh | bash -s 13.2.0
        ```
      </Tab>

      <Tab title="Enterprise">
        <Tabs>
          <Tab title="Debian 8+/Ubuntu 16.04+ (apt)">
            ```code
            # Download Teleport's PGP public key
            $ sudo curl https://apt.releases.teleport.dev/gpg \
            -o /usr/share/keyrings/teleport-archive-keyring.asc
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport APT repository for v13. You'll need to update this
            # file for each major release of Teleport.
            $ echo "deb [signed-by=/usr/share/keyrings/teleport-archive-keyring.asc] \
            https://apt.releases.teleport.dev/${ID?} ${VERSION_CODENAME?} stable/v13" \
            | sudo tee /etc/apt/sources.list.d/teleport.list > /dev/null

            $ sudo apt-get update
            $ sudo apt-get install teleport-ent
            ```

            For FedRAMP/FIPS-compliant installations, install the `teleport-ent-fips` package instead:

            ```code
            $ sudo apt-get install teleport-ent-fips
            ```
          </Tab>

          <Tab title="Amazon Linux 2/RHEL 7 (yum)">
            ```code
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport YUM repository for v13. You'll need to update this
            # file for each major release of Teleport.
            # First, get the major version from $VERSION_ID so this fetches the correct
            # package version.
            $ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
            $ sudo yum-config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/v13/teleport.repo")"
            $ sudo yum install teleport-ent
            #
            # Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
            # echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
            ```

            For FedRAMP/FIPS-compliant installations, install the `teleport-ent-fips` package instead:

            ```code
            $ sudo yum install teleport-ent-fips
            ```
          </Tab>

          <Tab title="Amazon Linux 2023/RHEL 8+ (dnf)">
            ```code
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport YUM repository for v13. You'll need to update this
            # file for each major release of Teleport.
            # Use the dnf config manager plugin to add the teleport RPM repo
            $ sudo dnf config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/v13/teleport.repo")"

            # Install teleport
            $ sudo dnf install teleport-ent

            # Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
            # echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
            ```

            For FedRAMP/FIPS-compliant installations, install the `teleport-ent-fips` package instead:

            ```code
            $ sudo dnf install teleport-ent-fips
            ```
          </Tab>

          <Tab title="Tarball">
            In the example commands below, update `$SYSTEM_ARCH` with the appropriate
            value (`amd64`, `arm64`, or `arm`). All example commands using this variable
            will update after one is filled out.

            ```code
            $ curl https://get.gravitational.com/teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-bin.tar.gz.sha256
            # <checksum> <filename>
            $ curl -O https://cdn.teleport.dev/teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-bin.tar.gz
            $ shasum -a 256 teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-bin.tar.gz
            # Verify that the checksums match
            $ tar -xvf teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-bin.tar.gz
            $ cd teleport-ent
            $ sudo ./install
            ```

            For FedRAMP/FIPS-compliant installations of Teleport Enterprise, package URLs
            will be slightly different:

            ```code
            $ curl https://get.gravitational.com/teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-fips-bin.tar.gz.sha256
            # <checksum> <filename>
            $ curl -O https://cdn.teleport.dev/teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-fips-bin.tar.gz
            $ shasum -a 256 teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-fips-bin.tar.gz
            # Verify that the checksums match
            $ tar -xvf teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-fips-bin.tar.gz
            $ cd teleport-ent
            $ sudo ./install
            ```
          </Tab>
        </Tabs>
      </Tab>

      <Tab title="Cloud">
        <Tabs>
          <Tab title="Debian 8+/Ubuntu 16.04+ (apt)">
            Add the Teleport repository to your repository list:

            ```code
            # Download Teleport's PGP public key
            $ sudo curl https://apt.releases.teleport.dev/gpg \
            -o /usr/share/keyrings/teleport-archive-keyring.asc
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport apt repository for cloud.
            $ echo "deb [signed-by=/usr/share/keyrings/teleport-archive-keyring.asc] \
            https://apt.releases.teleport.dev/${ID?} ${VERSION_CODENAME?} stable/cloud" \
            | sudo tee /etc/apt/sources.list.d/teleport.list > /dev/null

            $ sudo apt-get update
            $ sudo apt-get install teleport-ent
            ```
          </Tab>

          <Tab title="Amazon Linux 2/RHEL 7 (yum)">
            ```code
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport yum repository for cloud.
            # First, get the major version from $VERSION_ID so this fetches the correct
            # package version.
            $ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
            $ sudo yum-config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/cloud/teleport.repo")"
            $ sudo yum install teleport-ent
            #
            # Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
            # echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
            ```
          </Tab>

          <Tab title="Amazon Linux 2023/RHEL 8+ (dnf)">
            ```code
            # Source variables about OS version
            $ source /etc/os-release
            # Add the Teleport yum repository for cloud.
            # Use the dnf config manager plugin to add the teleport RPM repo
            $ sudo dnf config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/cloud/teleport.repo")"

            # Install teleport
            $ sudo dnf install teleport-ent

            # Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
            # echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
            ```
          </Tab>

          <Tab title="Tarball">
            In the example commands below, update `$SYSTEM_ARCH` with the appropriate
            value (`amd64`, `arm64`, or `arm`). All example commands using this variable
            will update after one is filled out.

            ```code
            $ curl https://get.gravitational.com/teleport-ent-v13.2.0-linux-$SYSTEM_ARCH-bin.tar.gz.sha256
            # <checksum> <filename>
            $ curl -O https://cdn.teleport.dev/teleport-ent-v13.2.0-linux-amd64-bin.tar.gz
            $ shasum -a 256 teleport-ent-v13.2.0-linux-amd64-bin.tar.gz
            # Verify that the checksums match
            $ tar -xvf teleport-ent-v13.2.0-linux-amd64-bin.tar.gz
            $ cd teleport-ent
            $ sudo ./install
            ```
          </Tab>
        </Tabs>

        <Accordion title="Is my Teleport instance compatible with Teleport Cloud?">
          Before installing a `teleport` binary with a version besides v13,
          read our compatibility rules to ensure that the binary is compatible with
          Teleport Cloud.

          When running multiple `teleport` binaries within a cluster, the following rules
          apply:

          - **Patch and minor** versions are always compatible, for example, any 8.0.1
            component will work with any 8.0.3 component and any 8.1.0 component will work
            with any 8.3.0 component.
          - Servers support clients that are 1 major version behind, but do not support
            clients that are on a newer major version. For example, an 8.x.x Proxy Service
            is compatible with 7.x.x resource services and 7.x.x `tsh`, but we don't
            guarantee that a 9.x.x resource service will work with an 8.x.x Proxy Service.
            This also means you must not attempt to upgrade from 6.x.x straight to 8.x.x.
            You must upgrade to 7.x.x first.
          - Proxy Services and resource services do not support Auth Services that are on
            an older major version, and will fail to connect to older Auth Services by
            default. This behavior can be overridden by passing `--skip-version-check`
            when starting Proxy Services and resource services.
        </Accordion>
      </Tab>
    </Tabs>

    Create the Teleport Application Service configuration at `/etc/teleport.yaml`.
    Replace TELEPORT.EXAMPLE.COM with your Teleport Proxy Service
    address (`teleport.example.com`) or Teleport Cloud tenant (e.g. `mytenant.teleport.sh`).

    ```code
    $ sudo teleport configure \
      -o file \
      --proxy=teleport.example.com:443 \
      --token=/tmp/token \
      --roles=app \
      --app-name=grafana \
      --app-uri=http://localhost:3000
    ```

    Make sure to update `--app-name` and `--app-uri` accordingly if you're using your
    own web application.

    The `--token` flag points to the file on the Application Service host where we
    stored the token that we generated earlier.

    Configure the Teleport Application Service to start automatically when the host boots up by
    creating a systemd service for it. The instructions depend on how you installed
    the Teleport Application Service.

    <Tabs>
      <Tab title="Package Manager">
        On the host where you will run the Teleport Application Service, enable and start Teleport:

        ```code
        $ sudo systemctl enable teleport
        $ sudo systemctl start teleport
        ```
      </Tab>

      <Tab title="TAR Archive">
        On the host where you will run the Teleport Application Service, create a systemd service
        configuration for Teleport, enable the Teleport service, and start Teleport:

        ```code
        $ sudo teleport install systemd -o /etc/systemd/system/teleport.service
        $ sudo systemctl enable teleport
        $ sudo systemctl start teleport
        ```
      </Tab>
    </Tabs>

    You can check the status of the Teleport Application Service with `systemctl status teleport`
    and view its logs with `journalctl -fu teleport`.
  </Tab>

  <Tab title="Kubernetes cluster">
    ## Step 2/4. Start Grafana

    We've picked Grafana for this tutorial since it's very easy to run with zero
    configuration required. If you have another web application you'd like to
    expose, skip over to **Step 3**. Install Grafana with these helm instructions
    and it will be available at `http://example-grafana.example-grafana.svc.cluster.local`
    within the Kubernetes cluster.

    ```code
    $ helm repo add grafana https://grafana.github.io/helm-charts
    $ helm repo update
    $ helm install example-grafana grafana/grafana \
        --create-namespace \
        --namespace example-grafana
    ```

    ## Step 3/4. Install and configure Teleport

    To allow Helm to install charts that are hosted in the Teleport Helm repository, use `helm repo add`:

    ```code
    $ helm repo add teleport https://charts.releases.teleport.dev
    ```

    To update the cache of charts from the remote repository, run `helm repo update`:

    ```code
    $ helm repo update
    ```

    Install the Teleport Kubernetes Service into your Kubernetes Cluster
    with the Teleport Application Service configuration.
    Replace TELEPORT.EXAMPLE.COM with
    your Teleport Proxy Service address (`teleport.example.com`) or your
    Teleport Enterprise Cloud tenant (e.g. `mytenant.teleport.sh`):

    ```code
    $ JOIN_TOKEN=$(cat /tmp/token)
    $ helm install teleport-kube-agent teleport/teleport-kube-agent \
      --create-namespace \
      --namespace teleport-agent \
      --set roles=app \
      --set proxyAddr=teleport.example.com:443 \
      --set authToken=${JOIN_TOKEN?} \
      --set "apps[0].name=grafana" \
      --set "apps[0].uri=http://example-grafana.example-grafana.svc.cluster.local" \
      --set "labels.env=dev" \
      --version 13.2.0
    ```

    Install the Teleport Kubernetes Service into your Kubernetes Cluster
    with the Teleport Application Service configuration.
    Replace TELEPORT.EXAMPLE.COM with
    your Teleport Enterprise Cloud tenant address (`mytenant.teleport.sh`)

    ```code
    $ JOIN_TOKEN=$(cat /tmp/token)
    $ helm install teleport-kube-agent teleport/teleport-kube-agent \
      --create-namespace \
      --namespace teleport-agent \
      --set roles=app \
      --set proxyAddr=teleport.example.com:443 \
      --set authToken=${JOIN_TOKEN?} \
      --set "apps[0].name=grafana" \
      --set "apps[0].uri=http://example-grafana.example-grafana.svc.cluster.local" \
      --set "labels.env=dev" \
      --version 13.2.0
    ```

    Make sure to update `apps[0].name` and `apps[0].uri` accordingly if you're using
    your own web application.
  </Tab>
</Tabs>

### Create a user

Next, let's create a user to access the application we've just connected.
Teleport has a built-in role called `access` that allows users to access
cluster resources. Create a local user assigned this role:

```code
$ tctl users add --roles=access alice
```

The command will output a signup link. Use it to choose a password and set up a
second factor. After that, it will take you to the Teleport Web UI.

## Step 4/4. Access the application

There are a couple of ways to access the proxied application.

Log in to the Teleport Web UI at your Proxy Service address. All available
applications are displayed on the Applications tab. Click Launch on the Grafana
application tile to access it.

Alternatively call the application directly with its name as the sub-domain,
e.g. `https://grafana.teleport.example.com` or `https://grafana.mytenant.teleport.sh`
for a Teleport Cloud tenant. You will need to log in if you weren't already authenticated.

## Next steps

Dive deeper into protecting applications with Teleport:

- Learn in more detail about [connecting applications](/docs/ver/13.x/application-access/guides/connecting-apps).
- Learn about integrating with [JWT tokens](/docs/ver/13.x/application-access/jwt/introduction) for auth.
- Learn how to use application access with [RESTful APIs](/docs/ver/13.x/application-access/guides/api-access).
- See full configuration and CLI [reference](/docs/ver/13.x/application-access/reference).
- Read about how Let's Encrypt uses the [ACME protocol](https://letsencrypt.org/how-it-works/).
